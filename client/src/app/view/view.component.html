<div class="border-container">
  <app-navbar></app-navbar>
  <body class="body-div">
    <h2 class="page-title">explore artist insights</h2>

    <div class="input-container">
      <input
        type="text"
        [(ngModel)]="artistName"
        placeholder="enter artist name"
        (keyup.enter)="displayStats()"
      />

      <a (click)="displayStats()" class="btn--action">
        <span class="fa fa-play"></span>
      </a>
    </div>

    <div *ngIf="!artistEntered">
      <p class="alert">oh no, artist name not entered</p>
    </div>

    <div *ngIf="!artistExists">
      <p class="alert-l">
        artist name may be misspelled or does not exist in the database :(
      </p>
    </div>

    <div *ngIf="emptyArray">
      <p class="alert">you haven't streamed any song by this artist yet</p>
    </div>

    <div *ngIf="isLoading" class="spinner-container">
      <p
        style="
          color: rgb(18, 14, 31);
          font-family: VT323, monospace;
          margin-left: 5%;
          margin-right: 1%;
          font-size: 1.5rem;
        "
      >
        loading ...
      </p>
      <i
        class="fa-solid fa-compact-disc fa-spin fa-2xl"
        style="color: #bc8884; margin-bottom: 1%"
      ></i>
    </div>

    <div *ngIf="!isLoading">
      <div *ngIf="showFoundArtist">
        <div class="found-artist">
        <p>
          You found this artist on <strong>{{ earliestListenDate }}</strong></p>
        </div>

        <div class="found-song">
         <p>
          and
          it was through the song <strong>{{ earliestListenSongName }}</strong>
        </p>
      </div>
      </div>

      <div *ngIf="showBarChart" class="bar-chart">
        <h3 class="bc-title">
          so that's how many times you heard each of their songs
        </h3>
        <ngx-charts-bar-horizontal
          [view]="[1000, 400]"
          [results]="barChartData"
          [xAxisLabel]="'Count'"
          [legendTitle]="'Play Count'"
          [yAxisLabel]="'Songs'"
          [legend]="true"
          [showXAxisLabel]="true"
          [showYAxisLabel]="true"
          [xAxis]="true"
          [yAxis]="true"
          [gradient]="true"
        >
        </ngx-charts-bar-horizontal>
      </div>

      <div *ngIf="showPieChart" class="pie-chart">
        <ngx-charts-pie-chart
          [results]="chartData"
          [legend]="true"
          [legendTitle]="'User Activity'"
          [view]="[1000, 300]"
          [labels]="true"
        >
        </ngx-charts-pie-chart>

        <p class="pc-p">
          you've listened to {{ pie_percent.toFixed(0) }}% of <br />
          the discography of {{ artistName }}
        </p>
      </div>

      <div *ngIf="viewUnlistened">
        <h3>incase you want to know the songs you missed, here u go</h3>
        <button (click)="toggleUnlistenedSongs()">show unlistened songs</button>
        <ul *ngIf="showUnlistenedSongs">
          <li *ngFor="let song of unlistenedSongs">{{ song }}</li>
        </ul>
      </div>
    </div>
    <div class="bottom-border"></div>
  </body>
</div>
